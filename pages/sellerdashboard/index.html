<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Seller Dashboard</title>

    <link href="../../assets/lib/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css">

    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="../../src/css/sellerdashboard.css">

</head>

<body>
    <header class="topbar py-2">
        <div class="container-fluid d-flex align-items-center justify-content-between">
            <div class="d-flex align-items-center gap-2">
                <!-- burger opens offcanvas on small screens -->
                <button class="btn btn-outline-secondary d-md-none" type="button" data-bs-toggle="offcanvas"
                    data-bs-target="#sidebarOffcanvas" aria-controls="sidebarOffcanvas" aria-label="Open menu">
                    <i class="bi bi-list" style="font-size:1.25rem"></i>
                </button>
                <a class="navbar-brand mb-0" href="#" style="font-weight:600;color:#111">Seller Dashboard</a>
            </div>

            <div class="d-flex align-items-center gap-2">
                <span class="d-none d-sm-inline text-muted small">Welcome, <b id="navUser"></b></span>
                <img src="https://api.dicebear.com/6.x/initials/svg?seed=MT" alt="avatar"
                    style="width:36px;height:36px;border-radius:50%;">
            </div>
        </div>
    </header>
    

    <!-- Responsive offcanvas (only used on small screens) -->
    <div class="offcanvas offcanvas-start d-md-none" tabindex="-1" id="sidebarOffcanvas" aria-labelledby="sidebarLabel">
        <div class="offcanvas-header">
            <h5 class="offcanvas-title text-white" id="sidebarLabel">Menu</h5>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas"
                aria-label="Close"></button>
        </div>
        <div class="offcanvas-body p-0">
            <nav class="nav flex-column px-2" style="background:var(--sidebar-bg); min-height:100vh; color:#fff;">
                <div class="px-3 pb-3 border-bottom" style="border-color: rgba(255,255,255,0.06) !important;">
                    <div style="font-weight:600;font-size:1.05rem;color:#fff;">Seller Dashboard</div>
                </div>
                <a class="nav-link active rounded-2 px-3 py-2 mt-3" href="./index.html"><i
                        class="bi bi-speedometer2 me-2"></i>
                    Dashboard</a>
                <a class="nav-link rounded-2 px-3 py-2" href="./products.html"><i class="bi bi-grid-1x2 me-2"></i>
                    Products</a>
                <a class="nav-link rounded-2 px-3 py-2" href="./orders.html"><i class="bi bi-cart3 me-2"></i> Orders</a>
                
            </nav>
        </div>
    </div>

    <div class="container-fluid" style="padding-left: 0  ; margin-left: 0;">
        <div class="row g-0">
            <!-- STATIC SIDEBAR: visible on md+ -->
            <aside class="col-0 col-md-3 col-lg-2 d-none d-md-block sidebar-col">
                <div class="static-sidebar h-100">
                    <div class="px-3 pb-3">
                        <div style="font-weight:600;font-size:1.05rem;color:#fff;">Seller Dashboard</div>
                    </div>
                    <nav class="nav flex-column px-2">
                        <a class="nav-link active rounded-2 px-3 py-2 mt-3" href="./index.html"><i
                                class="bi bi-speedometer2 me-2"></i> Dashboard</a>
                        <a class="nav-link rounded-2 px-3 py-2" href="./products.html"><i
                                class="bi bi-grid-1x2 me-2"></i>
                            Products</a>
                        <a class="nav-link rounded-2 px-3 py-2" href="./orders.html"><i class="bi bi-cart3 me-2"></i>
                            Orders</a>
                        
                </div>
            </aside>

            <!-- MAIN CONTENT -->

            <main class="col-12 col-md-9 col-lg-10 p-3">
                <!-- Statistics row -->
                <div class="row g-3">
                    <div class="col-6 col-lg-3">
                        <div class="stat-card stat-green">
                            <div>
                                <div style="opacity:.9;font-size:0.95rem">Total Revenue</div>
                                <div id="totalRevenue" style="font-size:1.15rem;font-weight:700">$0</div>
                            </div>
                            <div class="stat-icon"><i class="bi bi-currency-dollar"></i></div>
                        </div>
                    </div>
                    <div class="col-6 col-lg-3">
                        <div class="stat-card stat-yellow">
                            <div>
                                <div style="opacity:.9;font-size:0.95rem">Total Products</div>
                                <div id="totalProduct" style="font-size:1.15rem;font-weight:700">7</div>
                            </div>
                            <div class="stat-icon"><i class="bi bi-box-seam"></i></div>
                        </div>
                    </div>
                    <div class="col-6 col-lg-3">
                        <div class="stat-card stat-blue">
                            <div>
                                <div style="opacity:.9;font-size:0.95rem">Total Orders</div>
                                <div id="totalOrders" style="font-size:1.15rem;font-weight:700">30</div>
                            </div>
                            <div class="stat-icon"><i class="bi bi-basket"></i></div>
                        </div>
                    </div>
                    <div class="col-6 col-lg-3">
                        <div class="stat-card stat-red">
                            <div>
                                <div style="opacity:.9;font-size:0.95rem">Total Sold Units</div>
                                <div id="totalSold" style="font-size:1.15rem;font-weight:700">0</div>
                            </div>
                            <div class="stat-icon"><i class="bi bi-bar-chart"></i></div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-12 col-md-9">
                        <!-- Analytics card with chart -->
                        <div class="card card-graph mt-3 p-3">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <h5 class="mb-0">Sales Analytics</h5>
                                <ul class="nav nav-pills">
                                    <li class="nav-item"><a class="nav-link active" data-bs-toggle="pill"
                                            href="#daily">Daily</a></li>
                                    <li class="nav-item"><a class="nav-link" data-bs-toggle="pill"
                                            href="#monthly">Monthly</a>
                                    </li>
                                    <li class="nav-item"><a class="nav-link" data-bs-toggle="pill"
                                            href="#yearly">Yearly</a>
                                    </li>
                                </ul>
                            </div>

                            <div style="min-height:320px;">
                                <canvas id="salesChart" style="width:100%;height:320px;"></canvas>
                            </div>
                        </div>



                        <!-- recent table -->
                        <div class="card mt-3 p-3">
                            <h6>Recent Data</h6>
                            <div class="table-responsive small">
                                <table class="table table-striped mb-0">
                                    <thead>
                                        <tr>
                                            <th>#</th>
                                            <th>Product</th>
                                            <th>Category</th>
                                            <th>Price</th>
                                            <th>Status</th>
                                        </tr>
                                    </thead>
                                    <tbody>

                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>


                    <aside class="mt-3 col-12  col-md-3">
                        <div class="card mb-3 right-card p-3"
                            style="background:linear-gradient(90deg,#14c6e8,#06b2da);color:#fff;">
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <div style="opacity:.95">Pending Orders</div>
                                    <div id="pendingOrders" style="font-size:1.4rem;font-weight:700">1</div>
                                </div>
                                <div style="font-size:26px;opacity:.95"><i class="bi bi-clock-history"></i></div>
                            </div>
                        </div>

                        <div class="card p-0">
                            <div class="card-body">
                                <ul class="nav nav-tabs" id="ordersTab" role="tablist">
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link active" id="recent-tab" data-bs-toggle="tab"
                                            data-bs-target="#recent" type="button" role="tab">Recent</button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link" id="best-tab" data-bs-toggle="tab"
                                            data-bs-target="#best" type="button" role="tab">Best</button>
                                    </li>
                                </ul>
                                <div class="tab-content mt-3">
                                    <div class="tab-pane fade show active" id="recent">No recent orders</div>
                                    <div class="tab-pane fade" id="best">No best selling yet</div>
                                </div>
                            </div>
                        </div>
                    </aside>

                </div>






            </main>
        </div>
    </div>


    <script>

        // calc total product 
        function calacTotalProduct() {
            let products = localStorage.getItem("products_store");
            let arrProducts = JSON.parse(products) || [];
            let productsLength = arrProducts.length;

            document.getElementById("totalProduct").innerHTML = productsLength;
            return;
        }

        // calc total orders and pending orders and deliverd products
        let allOrders = [];
        function calacTotalOrders() {
            let orders = localStorage.getItem("orders_store");
            let arrOrders = JSON.parse(orders) || [];
            allOrders = arrOrders;

            let ordersLength = arrOrders.length;

            document.getElementById("totalOrders").innerHTML = ordersLength;

            // pending Orders

            let pendingOrders = arrOrders.filter(o => o.status === "Pending");
            let totalPendingOrders = pendingOrders.length;

            document.getElementById("pendingOrders").innerHTML = totalPendingOrders;

        }


        document.addEventListener("load", calacTotalProduct());
        document.addEventListener("load", calacTotalOrders());


        //calc Sold Units and price

        function calcSoldUnits() {
            let activeOrders = allOrders.filter(o => o.status === "Delivered" || o.status === "Shipped")
            let soldUnits = 0;
            let priceSoldUnits = 0;
            for (let i = 0; i < activeOrders.length; i++) {
                for (let x = 0; x < activeOrders[i].products.length; x++) {
                    soldUnits += activeOrders[i].products[x].qty;
                    priceSoldUnits += (activeOrders[i].products[x].price) * (activeOrders[i].products[x].qty);
                }
            }
            document.getElementById("totalSold").innerHTML = soldUnits;
            document.getElementById("totalRevenue").innerHTML = priceSoldUnits + " $";
        }
        document.addEventListener("load", calcSoldUnits());


    </script>

    <!-- Chart.js (must load before using Chart in inline script) -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.3.2/dist/chart.umd.js"></script>
    <script src="../../assets/lib/js/bootstrap.bundle.min.js" defer></script>

    <script src="../../src/js/chart.js"></script>
    <script defer src="../../assets/lib/js/crypto-js.min.js"></script>
    <script defer src="../../src/js/shared.js"></script>
    <script defer src="../../src/js/product_seller.js"></script>
</body>

</html>