<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Cart Functionality</title>
    <link rel="stylesheet" href="./assets/lib/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css">
</head>
<body>
    <div class="container mt-5">
        <h1>Test Cart Functionality</h1>
        
        <div class="row">
            <div class="col-md-4">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Test Product</h5>
                        <p class="card-text">This is a test product to verify cart functionality.</p>
                        <button class="btn btn-primary" onclick="testAddToCart()">
                            <i class="fa fa-shopping-cart me-1"></i> Add to Cart
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="mt-4">
            <h3>Cart Items:</h3>
            <div id="cartItems"></div>
        </div>
    </div>

    <script src="./assets/lib/js/bootstrap.bundle.min.js"></script>
    <script src="./assets/lib/js/crypto-js.min.js"></script>
    <script src="./src/js/shared.js"></script>
    <script>
        // Test product data
        const testProduct = {
            id: 999,
            name: "Test Product",
            price: 1000,
            stock: 10,
            images: ["test-image.jpg"],
            description: "This is a test product"
        };

        function testAddToCart() {
            console.log("Testing addToCartFromCatalog with:", testProduct);
            
            if (window.addToCartFromCatalog) {
                window.addToCartFromCatalog(testProduct);
            } else {
                console.error("addToCartFromCatalog function not found");
                if (window.addToCart) {
                    window.addToCart(testProduct, 1);
                } else {
                    console.error("addToCart function not found");
                }
            }
        }

        // Display cart items
        function displayCartItems() {
            const cartItemsDiv = document.getElementById('cartItems');
            const cart = JSON.parse(localStorage.getItem('cart') || '[]');
            
            if (cart.length === 0) {
                cartItemsDiv.innerHTML = '<p class="text-muted">Cart is empty</p>';
            } else {
                cartItemsDiv.innerHTML = cart.map(item => 
                    `<div class="card mb-2">
                        <div class="card-body">
                            <h6>${item.name}</h6>
                            <p>Price: EGP ${item.price} | Quantity: ${item.qty}</p>
                        </div>
                    </div>`
                ).join('');
            }
        }

        // Listen for cart updates
        document.addEventListener('cartUpdated', function(event) {
            console.log('Cart updated:', event.detail);
            displayCartItems();
        });

        // Initial display
        displayCartItems();
    </script>
</body>
</html>
